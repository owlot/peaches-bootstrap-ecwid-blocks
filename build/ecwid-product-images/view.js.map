{"version":3,"file":"ecwid-product-images/view.js","mappings":"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","sources":["webpack://peaches-bootstrap-ecwid-blocks/external module \"@wordpress/interactivity\"","webpack://peaches-bootstrap-ecwid-blocks/webpack/bootstrap","webpack://peaches-bootstrap-ecwid-blocks/webpack/runtime/make namespace object","webpack://peaches-bootstrap-ecwid-blocks/./src/ecwid-product-images/view.js"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { store, getContext } from '@wordpress/interactivity';\n\n// Access the parent product detail store\nconst productDetailStore = store('peaches-ecwid-product-detail');\n\n// Store definition with proper lifecycle methods\nconst { state, actions } = store('peaches-ecwid-product-images', {\n    state: {\n        get productId() {\n            return productDetailStore.state.productId;\n        },\n        get productData() {\n            return productDetailStore.state.productData;\n        },\n        productName: '',\n        currentImage: '',\n        galleryImages: [],\n\n        processProductData() {\n            try {\n                const product = state.productData;\n\n                if (!product) {\n                    console.error('Product data not found');\n                    return;\n                }\n\n                // Set the product data\n                state.productName = product.name;\n\n                // Process images based on image size setting\n                const element = document.querySelector('[data-wp-interactive=\"peaches-ecwid-product-images\"]');\n                const imageSize = element.getAttribute('data-image-size') || 'medium';\n\n                // Updated size mapping to match the actual properties in the product media object\n                const sizeMapping = {\n                    small: 'image160pxUrl',\n                    medium: 'image400pxUrl',\n                    large: 'image800pxUrl',\n                    xlarge: 'image1500pxUrl',\n                    original: 'imageOriginalUrl'\n                };\n\n                const imageSizeKey = sizeMapping[imageSize] || 'image400pxUrl'; // Default to medium\n\n                // Handle media.images first (newer API structure)\n                if (product.media && product.media.images && product.media.images.length > 0) {\n                    // Set the main image using the correct URL property\n                    const mainImage = product.media.images[0];\n                    state.currentImage = mainImage[imageSizeKey] || mainImage.image400pxUrl;\n\n                    // Set gallery images with the correct URL properties\n                    state.galleryImages = product.media.images.map(image => ({\n                        thumbnailUrl: image.image160pxUrl, // Use the smallest image for thumbnails\n                        imageUrl: image[imageSizeKey] || image.image400pxUrl,\n\t\t\t\t\t\tisCurrent: image[imageSizeKey] === state.currentImage\n                    }));\n                }\n                // Fall back to legacy galleryImages if available\n                else if (product.images && product.images.length > 0) {\n                    // For backward compatibility with older product data structure\n                    const fallbackSizeMapping = {\n                        small: 'thumbnailUrl',\n                        medium: 'imageUrl',\n                        large: 'largeImageUrl',\n                        original: 'originalImageUrl'\n                    };\n\n                    const fallbackImageSizeKey = fallbackSizeMapping[imageSize] || 'imageUrl';\n\n                    state.currentImage = product.images[0][fallbackImageSizeKey] || product.images[0].imageUrl;\n\n                    state.galleryImages = product.images.map(image => ({\n                        thumbnailUrl: image.thumbnailUrl,\n\t\t\t\t\t\timageUrl: image[fallbackImageSizeKey] || image.imageUrl,\n\t\t\t\t\t\tisCurrent: (image[fallbackImageSizeKey] || image.imageUrl) === state.currentImage\n                    }));\n                }\n                // Last resort, use the main product image\n                else if (product.imageUrl) {\n                    state.currentImage = product.imageUrl;\n                    state.galleryImages = [];\n                }\n                else {\n                    console.error('No images found for product');\n                    state.currentImage = ''; // Set to empty or a placeholder image URL\n                    state.galleryImages = [];\n                }\n\n                // Debug output to verify the image URLs\n                console.log('Current image set to:', state.currentImage);\n                console.log('Gallery images:', state.galleryImages);\n\n            } catch (error) {\n                console.error('Error processing product data:', error);\n            }\n        }\n    },\n\n    actions: {\n        setCurrentImage(event) {\n\t\t\tconst imageUrl = event.target.getAttribute('data-imageUrl');\n\t\t\tif (imageUrl) {\n\t\t\t\tstate.currentImage = imageUrl;\n\t\t\t\tstate.galleryImages.forEach(image => {\n\t\t\t\t\timage.isCurrent = image.imageUrl === imageUrl;\n\t\t\t\t});\n\t\t\t}\n        }\n    },\n\n    // The callbacks section for lifecycle methods\n    callbacks: {\n        // This will be automatically called when the component is mounted via data-wp-init\n        initProductImages: function*() {\n            if (!state.productId || !state.productData) {\n                console.error('Product data not available');\n                return;\n            }\n\n            try {\n                // Process product data that's already available from parent block\n                state.processProductData();\n            } catch (error) {\n                console.error('Error processing product images:', error);\n            }\n        }\n    },\n});\n\n"],"names":["store","getContext","productDetailStore","state","actions","productId","productData","productName","currentImage","galleryImages","processProductData","product","console","error","name","element","document","querySelector","imageSize","getAttribute","sizeMapping","small","medium","large","xlarge","original","imageSizeKey","media","images","length","mainImage","image400pxUrl","map","image","thumbnailUrl","image160pxUrl","imageUrl","isCurrent","fallbackSizeMapping","fallbackImageSizeKey","log","setCurrentImage","event","target","forEach","callbacks","initProductImages"],"sourceRoot":""}